# Vite 使用指南

## 概述

Vite 是一个现代化的前端构建工具，它基于 ES Module 原生特性，为开发者提供极速的开发体验和高效的生产环境构建。

## 核心特性

### 🚀 开箱即用 (Zero Configuration)
Vite 采用约定大于配置的理念，无需复杂的配置文件即可开始开发：
- 内置对 TypeScript、JSX、CSS 等的支持
- 智能的热更新 (HMR)
- 开发服务器秒级启动

## ES Module 原理解析

### 模块导入的路径解析规则

ES Module 标准规定，模块导入只支持以下两种路径格式：

```javascript
// ✅ 相对路径
import utils from './utils.js'
import config from '../config/index.js'

// ✅ 绝对路径（完整 URL）
import lodash from 'https://cdn.skypack.dev/lodash'

// ❌ 裸导入（Bare Import）- 浏览器原生不支持
import lodash from 'lodash'
```

### 为什么浏览器不支持 node_modules 自动解析？

#### 📊 性能瓶颈
浏览器基于网络请求模型加载模块，如果支持 `node_modules` 自动搜索：

```javascript
import _ from 'lodash'
// 如果浏览器自动解析，可能触发：
// → /node_modules/lodash/index.js (网络请求 1)
//   → 内部又导入了其他模块 (网络请求 2, 3, 4...)
//     → 形成依赖链，可能产生数百个网络请求
```

这种"瀑布式"的网络请求会严重影响页面加载性能。

#### 🔄 与 CommonJS 的根本差异

| 特性 | CommonJS (Node.js) | ES Module (浏览器) |
|------|-------------------|-------------------|
| 加载方式 | 文件系统同步读取 | 网络异步请求 |
| 路径解析 | 支持 node_modules 搜索 | 仅支持明确路径 |
| 性能影响 | 文件 I/O，相对较快 | 网络请求，延迟较高 |

## Vite 的核心解决方案

### 路径重写机制

Vite 在开发过程中会拦截和重写模块导入：

```javascript
// 开发者编写
import _ from 'lodash'

// Vite 重写后
import _ from '/node_modules/.vite/deps/lodash.js?v=4d2cde77'
```

### 依赖预构建

Vite 通过依赖预构建解决了三个核心问题：
1. **统一模块格式**：将 CommonJS 转换为 ES Module
2. **路径标准化**：生成浏览器可识别的绝对路径
3. **网络优化**：减少 HTTP 请求数量

## 最佳实践

### 开发环境
```bash
# 启动开发服务器
npm run dev
# 访问 http://localhost:5173
```

### 生产环境
```bash
# 构建生产版本
npm run build
# 预览构建结果
npm run preview
```

> **提示**：Vite 在生产环境使用 Rollup 进行打包，确保最优的构建结果。