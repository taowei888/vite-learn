# Vite 中的 CSS 处理

Vite 天生支持对 CSS 文件的直接处理，无需额外配置即可使用。

## CSS 处理机制

当在 JavaScript 文件中导入 CSS 文件时，Vite 的处理流程如下：

1. Vite 检测到 `main.js` 中引用了 `index.css`
2. 使用 fs 模块读取 `index.css` 文件内容
3. 创建一个 `<style>` 标签，将 CSS 内容复制到标签内
4. 将 `<style>` 标签插入到 `index.html` 的 `<head>` 中
5. 将 CSS 文件内容替换为 JS 脚本（便于热更新和模块化），同时设置 Content-Type 为 JavaScript

## CSS 样式冲突问题

在多人协作开发中，容易出现样式冲突的问题：

**常见场景：**
- 组件最外层元素通常命名为 `.wrapper`
- 组件底层元素通常命名为 `.footer`

当多个开发者都使用相同的类名（如 `.footer`）时，由于 CSS 的全局性，后加载的样式会覆盖先加载的样式，导致样式冲突。

## CSS Modules 解决方案

CSS Modules 专门用于解决样式冲突问题。

### 工作原理

基于 Node.js 环境，CSS Modules 的处理流程：

1. **文件命名约定**：使用 `.module.css` 后缀（`module` 是开启 CSS 模块化的约定）
2. **类名转换**：将所有类名按规则替换（如 `footer` → `_footer_i22st_1`）
3. **映射对象**：创建类名映射对象 `{ footer: "_footer_i22st_1" }`
4. **样式注入**：将转换后的样式插入到 `<head>` 标签中
5. **脚本替换**：将 `.module.css` 文件内容替换为 JS 脚本
6. **导出映射**：在脚本中默认导出映射对象

### 实际使用示例

**CSS 模块文件**（`componentA.module.css`）：
```css
.footer {
    width: 100px;
    height: 100px;
    background-color: red;
}
```

**JavaScript 中使用**（`componentA.js`）：
```javascript
import componentA from "./componentA.module.css"
console.log('componentA', componentA) // { footer: "_footer_i22st_1" }

const div = document.createElement("div")
div.className = componentA.footer // 使用转换后的类名
document.body.appendChild(div)
```

## Less 预处理器

Vite 同时支持 Less 预处理器，提供了便捷实用的功能：

**示例**（`index.module.less`）：
```less
.content {
    .main {
        background-color: green;
    }
}
```

**使用方式**：
```javascript
import componentLess from "./index.module.less"
console.log('componentLess', componentLess)
```

## 项目中的 CSS 使用情况

当前项目包含以下 CSS 相关文件：
- `index.css` - 全局样式
- `componentA.module.css` / `componentB.module.css` - CSS 模块
- `index.module.less` - Less 预处理器模块