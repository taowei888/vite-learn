# Vite 中的 SVG 资源处理

Vite 对 SVG 依旧是开箱即用的，无需额外配置即可处理 SVG 资源。

## SVG 简介

### 什么是 SVG

**SVG**：Scalable Vector Graphics（可伸缩矢量图形）- 一种新的图片格式

### SVG vs 传统图片格式

#### 传统图片格式（jpg, jpeg, png 等）
- 位图格式，放大会失真
- 文件体积相对较大
- 适合表现复杂的图像内容

#### SVG 的优势
1. **不会失真**：矢量图形，无论如何缩放都保持清晰
2. **尺寸小**：通常比同等效果的位图文件更小
3. **可编程**：可以通过 CSS 和 JavaScript 控制样式和行为
4. **SEO 友好**：搜索引擎可以索引 SVG 中的文本内容

#### SVG 的局限性
- **表现力有限**：没法很好地表示层次丰富的图片信息
- **复杂图像不适用**：不适合照片等复杂图像

### SVG 的应用场景

在前端领域，我们更多的是用 SVG 来做：
- **图标系统**：各种 UI 图标
- **简单插图**：Logo、简单的装饰图形
- **可交互图形**：图表、数据可视化

## 项目结构

```
test-vite/
└── src/
    ├── svgLoader.js          # SVG 加载器
    └── assets/
        └── svgs/
            └── fullScreen.svg # 全屏图标
```

## SVG 资源处理方式

### 1. URL 模式（第一种方式）

```javascript
// svgLoader.js
import svgIcon from "./assets/svgs/fullScreen.svg?url";

console.log("svgIcon", svgIcon); // 输出：/src/assets/svgs/fullScreen.svg

// 使用方式：创建 img 元素
const img = document.createElement("img");
img.src = svgIcon;
document.body.appendChild(img);
```

**特点：**
- 返回 SVG 文件的 URL 路径
- 适用于简单的图片显示
- 无法直接控制 SVG 内部样式

### 2. Raw 模式（第二种方式）

```javascript
// svgLoader.js
import svgRaw from "./assets/svgs/fullScreen.svg?raw";

console.log("svgRaw", svgRaw); // 输出：完整的 SVG 代码字符串

// 使用方式：直接插入 HTML
document.body.innerHTML = svgRaw;
```

**特点：**
- 返回 SVG 的原始代码内容
- 可以直接插入到 DOM 中
- 支持 CSS 和 JavaScript 控制

## 实际应用示例

### SVG 文件内容（fullScreen.svg）

```xml
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg t="1660369691838" 
     class="icon" 
     viewBox="0 0 1024 1024" 
     version="1.1" 
     xmlns="http://www.w3.org/2000/svg" 
     width="200" 
     height="200">
  <path d="M768 298.656h170.656V384h-256V128H768v170.656z..." 
        p-id="7115">
  </path>
</svg>
```

### 完整的 SVG 加载器实现

```javascript
// svgLoader.js
import svgIcon from "./assets/svgs/fullScreen.svg?url";
import svgRaw from "./assets/svgs/fullScreen.svg?raw";

console.log("svgIcon", svgIcon, svgRaw);

// 第二种加载 SVG 的方式：Raw 模式
document.body.innerHTML = svgRaw;

// 获取插入的 SVG 元素
const svgElement = document.getElementsByTagName("svg")[0];

// 添加交互效果
svgElement.onmouseenter = function () {
    // 注意：SVG 元素使用 fill 属性而不是 background 或 color
    this.style.fill = "red";
}

// 第一种使用 SVG 的方式：URL 模式（已注释）
// const img = document.createElement("img");
// img.src = svgIcon;
// document.body.appendChild(img);
```

### 在 main.js 中的使用

```javascript
// main.js
import './src/svgLoader'  // 导入 SVG 加载器
```

## 两种使用方式对比

### 方式一：URL 模式 + img 标签

```javascript
import svgIcon from "./assets/svgs/fullScreen.svg?url";

const img = document.createElement("img");
img.src = svgIcon;
document.body.appendChild(img);
```

**优点：**
- 使用简单，类似普通图片
- 浏览器缓存友好

**缺点：**
- 无法控制 SVG 内部样式
- 无法添加交互效果
- 样式修改受限

### 方式二：Raw 模式 + innerHTML

```javascript
import svgRaw from "./assets/svgs/fullScreen.svg?raw";

document.body.innerHTML = svgRaw;

// 可以直接操作 SVG 元素
const svgElement = document.getElementsByTagName("svg")[0];
svgElement.style.fill = "red";
```

**优点：**
- 完全控制 SVG 元素
- 支持 CSS 样式修改
- 支持 JavaScript 交互
- 可以修改 `fill`、`stroke` 等 SVG 特有属性

**缺点：**
- 增加 HTML 体积
- 每次使用都会插入完整代码

## SVG 样式控制要点

### 关键属性

```css
svg {
    fill: red;           /* 填充颜色 */
    stroke: blue;        /* 描边颜色 */
    stroke-width: 2px;   /* 描边宽度 */
    width: 100px;        /* 宽度 */
    height: 100px;       /* 高度 */
}
```

### 交互效果

```javascript
svgElement.onmouseenter = function () {
    // SVG 使用 fill 属性控制颜色，而不是 background-color
    this.style.fill = "red";
}

svgElement.onmouseleave = function () {
    this.style.fill = "black";
}
```

## 最佳实践

### 1. 选择合适的加载方式

- **静态显示**：使用 `?url` 模式 + `<img>` 标签
- **动态控制**：使用 `?raw` 模式 + `innerHTML`

### 2. SVG 优化

```xml
<!-- 保持 viewBox 以确保缩放正常 -->
<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
  <path d="..."/>
</svg>
```

### 3. 样式管理

```css
/* 使用 CSS 变量便于主题切换 */
.icon-svg {
    fill: var(--icon-color, #333);
    width: var(--icon-size, 24px);
    height: var(--icon-size, 24px);
}
```

### 4. 组件化使用

```javascript
// 创建 SVG 图标组件
function createSVGIcon(rawSVG, className = '') {
    const container = document.createElement('div');
    container.innerHTML = rawSVG;
    const svg = container.querySelector('svg');
    if (className) svg.classList.add(className);
    return svg;
}
```

## 总结

Vite 对 SVG 的处理提供了两种主要方式：

1. **URL 模式**：适合简单的图片显示场景
2. **Raw 模式**：适合需要样式控制和交互的场景

根据实际需求选择合适的方式，能够充分发挥 SVG 的优势，创建高质量的图标系统和可交互的矢量图形。